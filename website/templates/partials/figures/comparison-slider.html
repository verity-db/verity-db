{# Mutable vs Immutable Comparison Slider Figure
   Before/after reveal between traditional DB and VerityDB paradigms #}

<section class="interactive-section" id="comparison" aria-labelledby="comparison-heading">
  <div class="wrapper">
    <header class="interactive-section__header flow" data-space="s">
      <h2 id="comparison-heading" class="section-title">Mutable vs. Immutable</h2>
      <p class="section-subtitle">
        Drag the slider to compare how traditional databases and VerityDB handle updates.
        <strong>One forgets. One remembers everything.</strong>
      </p>
    </header>

    <figure
      class="interactive-section__figure"
      data-signals="{ sliderPos: 50 }"
    >
      <header class="interactive-section__figure-header">
        <span class="interactive-section__fig-label">Fig. 9</span>
        <span class="interactive-section__fig-caption">Drag the slider or click the labels to reveal each paradigm.</span>
      </header>

      <div class="interactive-section__figure-content">
        <div
          class="comparison-slider"
          data-attr:style="'--slider-pos: ' + $sliderPos + '%'"
        >
          {# Slider header bar with buttons and track #}
          <div class="comparison-slider__header">
            <button
              class="comparison-slider__label comparison-slider__label--before"
              data-class:is-selected="$sliderPos <= 10"
              data-on:click="$sliderPos = 0"
              aria-label="Show Traditional DB view"
            >Traditional DB</button>

            <div class="comparison-slider__track">
              <input
                type="range"
                class="comparison-slider__input"
                min="0"
                max="100"
                data-attr:value="$sliderPos"
                data-on:input="$sliderPos = evt.target.valueAsNumber"
                aria-label="Comparison slider"
              >
            </div>

            <button
              class="comparison-slider__label comparison-slider__label--after"
              data-class:is-selected="$sliderPos >= 90"
              data-on:click="$sliderPos = 100"
              aria-label="Show VerityDB view"
            >VerityDB</button>
          </div>

          <div class="comparison-slider__container">
            {# Before Panel - Traditional DB (Mutable) #}
            <div class="comparison-slider__before">
              <h3 class="comparison-slider__title">Mutable State</h3>

              <div class="comparison-slider__code">UPDATE patients
SET name = 'Jane Smith'
WHERE id = 1;</div>

              <p class="comparison-slider__comment comparison-slider__comment--warning">
                -- Previous value: GONE FOREVER<br>
                -- History: Non-existent
              </p>

              <div class="comparison-slider__visual">
                <p class="comparison-slider__comment">Current row:</p>
                <div class="comparison-slider__row">
                  <span>id: 1</span>
                  <span>name: <strong>Jane Smith</strong></span>
                </div>
                <div class="comparison-slider__row comparison-slider__row--deleted">
                  <span>id: 1</span>
                  <span>name: Jane Doe</span>
                  <span class="comparison-slider__comment">(overwritten)</span>
                </div>
              </div>

              <div class="comparison-slider__question">
                "What's the current value?"
              </div>
            </div>

            {# After Panel - VerityDB (Immutable) #}
            <div class="comparison-slider__after">
              <h3 class="comparison-slider__title">Immutable Log</h3>

              <div class="comparison-slider__code">UPDATE patients
SET name = 'Jane Smith'
WHERE id = 1;</div>

              <p class="comparison-slider__comment">
                -- Creates Event #47<br>
                -- Previous events preserved
              </p>

              <div class="comparison-slider__visual">
                <p class="comparison-slider__comment">Event history:</p>
                <div class="comparison-slider__stack">
                  <div class="comparison-slider__version">
                    <span class="comparison-slider__version-offset">#47</span>
                    <span>UPDATE name = 'Jane Smith'</span>
                    <span class="comparison-slider__version-time">09:30:00</span>
                  </div>
                  <div class="comparison-slider__version">
                    <span class="comparison-slider__version-offset">#23</span>
                    <span>UPDATE name = 'Jane Doe'</span>
                    <span class="comparison-slider__version-time">09:15:00</span>
                  </div>
                  <div class="comparison-slider__version">
                    <span class="comparison-slider__version-offset">#1</span>
                    <span>INSERT (id=1, name='Jane')</span>
                    <span class="comparison-slider__version-time">09:00:00</span>
                  </div>
                </div>
              </div>

              <div class="comparison-slider__question">
                "What happened, and when?"
              </div>
            </div>
          </div>
        </div>
      </div>
    </figure>
  </div>
</section>

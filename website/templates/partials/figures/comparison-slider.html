{# Mutable vs Immutable Comparison Slider Figure
   Before/after reveal between traditional DB and Craton paradigms #}

<section class="interactive-section" id="comparison" aria-labelledby="comparison-heading">
  <div class="wrapper">
    <header class="interactive-section__header flow" data-space="s">
      <h2 id="comparison-heading" class="section-title">Mutable vs. Immutable</h2>
      <p class="section-subtitle">
        Drag the slider to compare how traditional databases and Craton handle updates.
        <strong>One forgets. One remembers everything.</strong>
      </p>
    </header>

    <figure
      class="interactive-section__figure"
      data-signals="{ sliderPos: 0 }"
    >
      <header class="interactive-section__figure-header">
        <span class="interactive-section__fig-label">Fig. 7</span>
        <span class="interactive-section__fig-caption">Drag the slider or click the labels to reveal each paradigm.</span>
      </header>

      <div class="interactive-section__figure-content">
        <div
          class="comparison-slider"
          data-attr:style="'--slider-pos: ' + $sliderPos + '%'"
        >
          {# Slider header bar with track above, buttons below #}
          <div class="comparison-slider__header">
            {# Full-width track at top #}
            <div class="comparison-slider__track">
              <input
                type="range"
                class="comparison-slider__input"
                min="0"
                max="100"
                data-bind:slider-pos
                aria-label="Comparison slider"
              >
            </div>

            {# Buttons row below slider #}
            <div class="comparison-slider__buttons">
              <button
                class="comparison-slider__label comparison-slider__label--before"
                data-attr:style="'--fill-pct: ' + (100 - $sliderPos) + '%'"
                data-attr:data-fill="$sliderPos <= 50 ? 'high' : 'low'"
                data-on:click="animateTo(v => $sliderPos = v, $sliderPos, 0, 300)"
                aria-label="Show Traditional DB view"
              >Traditional DB</button>

              <button
                class="comparison-slider__label comparison-slider__label--after"
                data-attr:style="'--fill-pct: ' + $sliderPos + '%'"
                data-attr:data-fill="$sliderPos >= 50 ? 'high' : 'low'"
                data-class:entice="$sliderPos < 10"
                data-on:click="animateTo(v => $sliderPos = v, $sliderPos, 100, 300)"
                aria-label="Show Craton view"
              ><span class="wave-text"><span style="--i:0">V</span><span style="--i:1">e</span><span style="--i:2">r</span><span style="--i:3">i</span><span style="--i:4">t</span><span style="--i:5">y</span><span style="--i:6">D</span><span style="--i:7">B</span></span></button>
            </div>
          </div>

          <div class="comparison-slider__container">
            {# Before Panel - Craton (Immutable) - revealed when slider moves right #}
            <div class="comparison-slider__before">
              <h3 class="comparison-slider__title">Immutable Log</h3>

              <div class="comparison-slider__code">UPDATE patients
SET name = 'Jane Smith'
WHERE id = 1;</div>

              <p class="comparison-slider__comment">
                -- Creates Event #47<br>
                -- Previous events preserved
              </p>

              <div class="comparison-slider__visual">
                <p class="comparison-slider__comment">Event history:</p>
                <div class="comparison-slider__stack">
                  <div class="comparison-slider__version">
                    <span class="comparison-slider__version-offset">#47</span>
                    <span>UPDATE name = 'Jane Smith'</span>
                    <span class="comparison-slider__version-time">09:30:00</span>
                  </div>
                  <div class="comparison-slider__version">
                    <span class="comparison-slider__version-offset">#23</span>
                    <span>UPDATE name = 'Jane Doe'</span>
                    <span class="comparison-slider__version-time">09:15:00</span>
                  </div>
                  <div class="comparison-slider__version">
                    <span class="comparison-slider__version-offset">#1</span>
                    <span>INSERT (id=1, name='Jane')</span>
                    <span class="comparison-slider__version-time">09:00:00</span>
                  </div>
                </div>
              </div>

              <div class="comparison-slider__question">
                "What happened, and when?"
              </div>
            </div>

            {# After Panel - Traditional DB (Mutable) - revealed when slider moves left #}
            <div class="comparison-slider__after">
              <h3 class="comparison-slider__title">Mutable State</h3>

              <div class="comparison-slider__code">UPDATE patients
SET name = 'Jane Smith'
WHERE id = 1;</div>

              <p class="comparison-slider__comment comparison-slider__comment--warning">
                -- Previous value: GONE FOREVER<br>
                -- History: Non-existent
              </p>

              <div class="comparison-slider__visual">
                <p class="comparison-slider__comment">Current row:</p>
                <div class="comparison-slider__row">
                  <span>id: 1</span>
                  <span>name: <strong>Jane Smith</strong></span>
                </div>
                <div class="comparison-slider__row comparison-slider__row--deleted">
                  <span>id: 1</span>
                  <span>name: Jane Doe</span>
                  <span class="comparison-slider__comment">(overwritten)</span>
                </div>
              </div>

              <div class="comparison-slider__question">
                "What's the current value?"
              </div>
            </div>
          </div>
        </div>
      </div>
    </figure>
  </div>
</section>
